<HTML>
<HEAD>
	<TITLE>autoTable</TITLE>


<script>
// Copyright (c)1996-2000 monospace. All Rights Reserved.
// Re-use only with this message intact.


function main(){
	var output = '';
	output += keyboard();	
	document.write(output);
	}



//globals
CAPS=false;
buffer = new Array();

//--------------------------------------------------------------------------

function tagIt(input, style){
	return '<' + style + '>' + input + '</' + style + '>';
	}


function imgTag(name, source, width, height, border){
	var tag = '<img name="' + name +'" src="' + source + '" width=' + width +  ' height=' + height + ' border=' + border + '>';
	return tag;
	}



function anchorTag(link, anchor, over, out){
	var tag = '<a href="' + link + '" onMouseOver="' + over + '" onMouseOut="' + out + '" onClick="this.blur()">';
	tag += anchor + '</a>';
	return tag;
	}


function keyboard(){
	var row = new Array(5);
	row[0] = "1 2 3 4 5 6 7 8 9 0 min eq".split(' ');
	row[1] = "Q W E R T Y U I O P caps enter".split(' ');
	row[2] = "A S D F G H J K L semi quot".split(' ');
	row[3] = "Z X C V B N M comma dot slash".split(' ');
	row[4] = "space".split(' ');
	var path ="images/keys/key_";
	var type =".gif";
	var keyboard = '';

	for (var r=0; r<4; r++){
		for (var k=0; k<row[r].length; k++){
			var keyCap = row[r][k];
			keyboard += anchorTag("javascript:keyStroke('"+keyCap+"')", imgTag('', path+keyCap+type, 41, 41, 0), '', '');
			}
		keyboard += '<br>';
		}
	keyboard += anchorTag("javascript:keyStroke('space')", imgTag('', path+'space'+type, 431, 25, 0), '', '');
	return keyboard;
	}


function display(text){
	window.status=text;
	return true;
	}


function keyStroke(key){
	
	if (key == 'caps') 
		{CAPS = !CAPS;}
	else{
		if (key == 'space')      {letter = ' ';}
		else if (key == 'enter') {letter = '<br>';}
		else if (key == 'min')   {letter = (CAPS)?'_':'-';}
		else if (key == 'eq')    {letter = (CAPS)?'+':'=';}
		else if (key == 'semi')  {letter = (CAPS)?':':';';}
		else if (key == 'quot')  {letter = (CAPS)?'\"':'\'';}
		else if (key == 'comma') {letter = (CAPS)?'&lt;':',';}
		else if (key == 'dot')   {letter = (CAPS)?'&gt;':'.';}
		else if (key == 'slash') {letter = (CAPS)?'?':'/';}
		else if (key == '1')     {letter = (CAPS)?'!':'1';}
		else if (key == '2')     {letter = (CAPS)?'@':'2';}
		else if (key == '3')     {letter = (CAPS)?'#':'3';}
		else if (key == '4')     {letter = (CAPS)?'$':'4';}
		else if (key == '5')     {letter = (CAPS)?'%':'5';}
		else if (key == '6')     {letter = (CAPS)?'^':'6';}
		else if (key == '7')     {letter = (CAPS)?'&':'7';}
		else if (key == '8')     {letter = (CAPS)?'*':'8';}
		else if (key == '9')     {letter = (CAPS)?'(':'9';}
		else if (key == '0')     {letter = (CAPS)?')':'9';}
		else                     {letter = (CAPS)?key:key.toLowerCase();}
		
		writeTape(letter);
	
	}
}
	

function writeTape(character){
	if (character != '') buffer[buffer.length] = character;
	
	output = '<html><body bgcolor=black>';
	output += '<table width=100% height=100%><tr><td valign=bottom >';
	output += '<table width=100% bgcolor=white background="images/paper_big_white.gif"><tr><td><font face="courier new, courier">';
	for (i=0; i<buffer.length; i++){
		if ((buffer[i] == '<br>') && (i == buffer.length-1)){
			output += buffer[i] + '&nbsp;';
		}else{
			output += buffer[i];
		}
	}
	output += '_</font></td></tr></table></td></tr></table>';
	output += '</body></html>';
	top.paper.document.open();
	top.paper.document.write(output);
	top.paper.document.close();
	}


function whiteOut(){
	if (buffer.length>0) buffer.length = buffer.length-1;
	writeTape('');
}


function resetForm(){
	if (confirm("Really discard your current writings?")){
		buffer = new Array();
		writeTape('');
	}
}


function submitForm(theForm){
	address = theForm.email.value;
	if (address != ''){
		if ((address.indexOf('.') != -1) && (address.indexOf('@') != -1)){
			if (buffer.length>0){
				for (i=0; i<buffer.length; i++){
					theForm.message.value += buffer[i];
				}
				buffer = new Array();
				writeTape('');
				//window.open("", "results", "width=100,height=100");
				theForm.submit();
			}else{
				alert("You didn't write anything!");
			}	
		}else{
			alert("Please enter a valid email address.");
		}
	}else{
		alert("Please enter a valid email address.");
	}
}


</script>


</HEAD>


<!----------------------------------------------------------->


<BODY bgcolor=000000 text=ffffff>

<center>

<script>main()</script>

<br><br>
<table><tr><td><font face="arial,helvetica">
<form target="_top" action="/cgi-bin/submitstory.cgi" action="put">
<input type=hidden name="message">
Your email address: <input type=text name="email" value="">&nbsp;&nbsp;&nbsp;<input type=button value="Submit Story" onClick="submitForm(this.form)">&nbsp;&nbsp;&nbsp;<input type=button value="Start Over" onClick="resetForm()"></form>
</td></tr></table>
</center>

</BODY>

</HTML>

